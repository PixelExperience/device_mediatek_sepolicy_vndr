# ==============================================
# MTK Policy Rule
# ============

#############################
# proc files
#
genfscon proc /driver/thermal u:object_r:proc_thermal:s0
genfscon proc /thermlmt u:object_r:proc_thermal:s0
genfscon proc /fps_tm u:object_r:proc_thermal:s0
genfscon proc /wmt_tm u:object_r:proc_thermal:s0
genfscon proc /mobile_tm u:object_r:proc_thermal:s0
genfscon proc /bcctlmt u:object_r:proc_thermal:s0
genfscon proc /battery_status u:object_r:proc_thermal:s0
genfscon proc /mtkcooler u:object_r:proc_mtkcooler:s0
genfscon proc /mtktz u:object_r:proc_mtktz:s0
genfscon proc /lk_env u:object_r:proc_lk_env:s0
genfscon proc /driver/storage_logger u:object_r:proc_slogger:s0
genfscon proc /driver/icusb u:object_r:proc_icusb:s0
genfscon proc /mrdump_rst u:object_r:proc_mrdump_rst:s0
genfscon proc /mtk_battery_cmd u:object_r:proc_battery_cmd:s0
genfscon proc /ged u:object_r:proc_ged:s0
genfscon proc /mtk_jpeg u:object_r:proc_mtk_jpeg:s0
genfscon proc /perfmgr u:object_r:proc_perfmgr:s0
genfscon proc /driver/wmt_dbg u:object_r:proc_wmtdbg:s0
genfscon proc /zraminfo u:object_r:proc_zraminfo:s0
genfscon proc /gpulog u:object_r:proc_gpulog:s0
genfscon proc /cpu/alignment u:object_r:proc_cpu_alignment:s0
genfscon proc /sched_debug u:object_r:proc_sched_debug:s0
genfscon proc /chip/hw_ver u:object_r:proc_chip:s0
genfscon proc /chip/info u:object_r:proc_chip:s0
genfscon proc /atf_log u:object_r:proc_atf_log:s0
genfscon proc /gz_log u:object_r:proc_gz_log:s0
genfscon proc /last_kmsg u:object_r:proc_last_kmsg:s0
genfscon proc /bootprof u:object_r:proc_bootprof:s0
genfscon proc /pl_lk u:object_r:proc_pl_lk:s0
genfscon proc /msdc_debug u:object_r:proc_msdc_debug:s0
genfscon proc /ufs_debug u:object_r:proc_ufs_debug:s0
genfscon proc /pidmap u:object_r:proc_pidmap:s0
genfscon proc /kpageflags u:object_r:proc_kpageflags:s0
genfscon proc /mtk_memcfg/slabtrace u:object_r:proc_slabtrace:s0
genfscon proc /mtk_cmdq_debug/status u:object_r:proc_cmdq_debug:s0
genfscon proc /cpuhvfs/dbg_repo u:object_r:proc_dbg_repo:s0

# mtk EM FreqHopping setting
genfscon proc /freqhopping/freqhopping_debug u:object_r:proc_freqhop:s0
genfscon proc /freqhopping/status u:object_r:proc_freqhop:s0
genfscon proc /freqhopping/dumpregs u:object_r:proc_freqhop:s0

# mtk EM flash reading
genfscon proc /partitions u:object_r:proc_partition:s0

# Purpose dump not exit file
genfscon proc /isp_p2/isp_p2_dump u:object_r:proc_isp_p2_dump:s0
genfscon proc /isp_p2/isp_p2_kedump u:object_r:proc_isp_p2_kedump:s0
genfscon proc /mali/memory_usage u:object_r:proc_memory_usage:s0
genfscon proc /mtk_es_reg_dump u:object_r:proc_mtk_es_reg_dump:s0

# Date : 2018/11/01
# Purpose : mtk EM c2k bypass read usb file
genfscon proc /isp_p2 u:object_r:proc_isp_p2:s0

# Date : WK19.27
# Purpose: Android Migration for SVP
genfscon proc /m4u u:object_r:proc_m4u:s0


#############################
# sysfs files
#
genfscon sysfs /bus/platform/drivers/mtk-kpd u:object_r:sysfs_keypad_file:s0
genfscon sysfs /power/vcorefs/pwr_ctrl u:object_r:sysfs_vcorefs_pwrctrl:s0
genfscon sysfs /power/dcm_state u:object_r:sysfs_dcm:s0
genfscon sysfs /power/mtkdcs/mode u:object_r:sysfs_dcs:s0
genfscon sysfs /power/mtkpasr/execstate u:object_r:sysfs_execstate:s0
genfscon sysfs /mtk_ssw u:object_r:sysfs_ssw:s0

# Date : 2018/06/15
# Purpose : mtk EM Audio headset detect
genfscon sysfs /bus/platform/drivers/Accdet_Driver/state u:object_r:sysfs_headset:s0
genfscon sysfs /bus/platform/drivers/dev_info/dev_info u:object_r:sysfs_devinfo:s0
genfscon sysfs /bus/platform/drivers/meta_com_type_info/meta_com_type_info u:object_r:sysfs_comport_type:s0
genfscon sysfs /bus/platform/drivers/meta_uart_port_info/meta_uart_port_info u:object_r:sysfs_uart_info:s0

genfscon sysfs /devices/platform/battery    u:object_r:sysfs_batteryinfo:s0
genfscon sysfs /devices/platform/charger/ADC_Charger_Voltage u:object_r:sysfs_vbus:s0
genfscon sysfs /devices/platform/battery/ADC_Charger_Voltage u:object_r:sysfs_vbus:s0
genfscon sysfs /devices/platform/charger/Pump_Express u:object_r:sysfs_pump_express:s0
genfscon sysfs /devices/platform/battery/Pump_Express u:object_r:sysfs_pump_express:s0
genfscon sysfs /devices/platform/mt_charger/power_supply u:object_r:sysfs_batteryinfo:s0
genfscon sysfs /devices/platform/mt-rtc/rtc    u:object_r:sysfs_rtc:s0
genfscon sysfs /devices/platform/mt-pmic u:object_r:sysfs_pmu:s0
genfscon sysfs /devices/platform/1000d000.pwrap/mt-pmic u:object_r:sysfs_pmu:s0
genfscon sysfs /devices/platform/1000d000.pwrap/1000d000.pwrap:mt6358-pmic/mt-pmic u:object_r:sysfs_pmu:s0
genfscon sysfs /devices/platform/1000d000.pwrap/1000d000.pwrap:mt6359-pmic/mt-pmic u:object_r:sysfs_pmu:s0
genfscon sysfs /devices/platform/mt6333-user u:object_r:sysfs_pmu:s0
genfscon sysfs /devices/platform/mt6311-user u:object_r:sysfs_pmu:s0
genfscon sysfs /devices/platform/mt_usb/musb-hdrc/dual_role_usb u:object_r:sysfs_dual_role_usb20:s0
genfscon sysfs /devices/platform/mt_usb/musb-hdrc/cmode u:object_r:sysfs_usb_cmode:s0

genfscon sysfs /devices/virtual/BOOT/BOOT/boot/boot_mode u:object_r:sysfs_boot_mode:s0
genfscon sysfs /devices/virtual/BOOT/BOOT/boot/boot_type u:object_r:sysfs_boot_type:s0

genfscon sysfs /devices/virtual/misc/md32  u:object_r:sysfs_md32:s0
genfscon sysfs /devices/virtual/misc/scp  u:object_r:sysfs_scp:s0
genfscon sysfs /devices/virtual/misc/scp_B  u:object_r:sysfs_scp:s0
genfscon sysfs /devices/virtual/misc/sspm  u:object_r:sysfs_sspm:s0
genfscon sysfs /devices/virtual/misc/adsp  u:object_r:sysfs_adsp:s0

genfscon sysfs /devices/virtual/thermal u:object_r:sysfs_therm:s0
genfscon sysfs /devices/virtual/switch/fps u:object_r:sysfs_fps:s0

genfscon sysfs /firmware/devicetree/base/chosen/atag,devinfo u:object_r:sysfs_devinfo:s0

genfscon sysfs /kernel/ccci u:object_r:sysfs_ccci:s0

# Date : 2018/06/15
# Purpose : mtk EM touchscreen settings
genfscon sysfs /module/tpd_debug u:object_r:sysfs_tpd_debug:s0
genfscon sysfs /module/tpd_setting  u:object_r:sysfs_tpd_setting:s0
genfscon sysfs /power/vcorefs/vcore_debug    u:object_r:sysfs_vcore_debug:s0
genfscon sysfs /power/vcorefs/opp_table    u:object_r:sysfs_vcore_debug:s0

# Date: 2018/08/09
#Purpose : MTK Vibrator
genfscon sysfs /devices/virtual/timed_output/vibrator u:object_r:sysfs_vibrator:s0
genfscon sysfs /devices/platform/odm/odm:vibrator@0/leds/vibrator u:object_r:sysfs_vibrator:s0
genfscon sysfs /devices/platform/leds-mt65xx/leds u:object_r:sysfs_leds:s0
# Date : 2018/08/109
# Purpose : mtk EM Power debug_log setting
genfscon sysfs /devices/platform/spm u:object_r:sysfs_spm:s0

# Date : 2018/11/01
# Purpose : mtk EM c2k bypass read usb file
genfscon sysfs /devices/virtual/usb_rawbulk u:object_r:sys_usb_rawbulk:s0

#Date : 2018/11/22
#Purpose: allow mdlogger to read mdinfo file
genfscon sysfs /kernel/md/mdee u:object_r:sysfs_mdinfo:s0

# Date : 2019/04/09
# Purpose: mtk EM battery temprature settings
genfscon sysfs /devices/platform/battery/Battery_Temperature u:object_r:sysfs_battery_temp:s0
genfscon sysfs /devices/platform/battery/FG_Battery_CurrentConsumption u:object_r:sysfs_battery_consumption:s0
genfscon sysfs /devices/platform/battery/Power_On_Voltage u:object_r:sysfs_power_on_vol:s0
genfscon sysfs /devices/platform/battery/Power_Off_Voltage u:object_r:sysfs_power_off_vol:s0
genfscon sysfs /devices/platform/battery/FG_daemon_disable u:object_r:sysfs_fg_disable:s0
genfscon sysfs /devices/platform/battery/disable_nafg u:object_r:sysfs_dis_nafg:s0

# Date : 2019/07/03
# Purpose: SIU update mmcblk access
genfscon sysfs /devices/platform/bootdevice/mmc_host/mmc0/mmc0:0001/block/mmcblk0 u:object_r:sysfs_mmcblk:s0
genfscon sysfs /devices/mtk-msdc.0/11230000.msdc0/mmc_host/mmc0/mmc0:0001/block/mmcblk0 u:object_r:sysfs_mmcblk:s0
genfscon sysfs /devices/platform/mtk-msdc.0/11230000.msdc0/mmc_host/mmc0/mmc0:0001/block/mmcblk0 u:object_r:sysfs_mmcblk:s0
genfscon sysfs /devices/platform/bootdevice/host0/target0:0:0/0:0:0:2/block/sdc u:object_r:sysfs_mmcblk:s0

# Date : 2019/07/12
# Purpose:dumpstate mmcblk1 access
genfscon sysfs /devices/platform/externdevice/mmc_host/mmc1 u:object_r:sysfs_devices_block:s0


#############################
# debugfs files
#
genfscon debugfs /binder u:object_r:debugfs_binder:s0
genfscon debugfs /blockio u:object_r:debugfs_blockio:s0
genfscon debugfs /cpuhvfs u:object_r:debugfs_cpuhvfs:s0
genfscon debugfs /displowpower u:object_r:debugfs_fb:s0
genfscon debugfs /disp u:object_r:debugfs_fb:s0
genfscon debugfs /dispsys u:object_r:debugfs_fb:s0
genfscon debugfs /dmlog u:object_r:debugfs_dmlog_debug:s0
genfscon debugfs /dynamic_debug u:object_r:debugfs_dynamic_debug:s0
genfscon debugfs /emi_mbw/dump_buf u:object_r:debugfs_emi_mbw_buf:s0
genfscon debugfs /fbconfig u:object_r:debugfs_fb:s0
genfscon debugfs /fpsgo u:object_r:debugfs_fpsgo:s0
genfscon debugfs /fuseio u:object_r:debugfs_fuseio:s0
genfscon debugfs /ged u:object_r:debugfs_ged:s0
genfscon debugfs /ion/client_history u:object_r:debugfs_ion_mm_heap:s0
genfscon debugfs /ion/clients u:object_r:debugfs_ion:s0
genfscon debugfs /ion/heaps u:object_r:debugfs_ion_mm_heap:s0
genfscon debugfs /ion/ion_mm_heap u:object_r:debugfs_ion_mm_heap:s0
genfscon debugfs /kmemleak u:object_r:debugfs_kmemleak:s0
genfscon debugfs /mali0/gpu_memory u:object_r:debugfs_gpu_mali_midgard:s0
genfscon debugfs /mali/gpu_memory u:object_r:debugfs_gpu_mali_utgard:s0
genfscon debugfs /mtkfb u:object_r:debugfs_fb:s0
genfscon debugfs /mmprofile u:object_r:debugfs_fb:s0
genfscon debugfs /musb-hdrc u:object_r:debugfs_usb:s0
genfscon debugfs /page_owner_slim u:object_r:debugfs_page_owner_slim_debug:s0
genfscon debugfs /pvr u:object_r:debugfs_gpu_img:s0
genfscon debugfs /rcu u:object_r:debugfs_rcu:s0
genfscon debugfs /shrinker u:object_r:debugfs_shrinker_debug:s0
genfscon debugfs /usb20_phy u:object_r:debugfs_usb20_phy:s0
genfscon debugfs /usb_c u:object_r:debugfs_usb:s0
genfscon debugfs /vpu/device_dbg u:object_r:debugfs_vpu_device_dbg:s0

# mtk VPU/MDLA power reading
genfscon debugfs  /vpu/power u:object_r:debugfs_vpu_power:s0
genfscon debugfs  /mdla/power u:object_r:debugfs_mdla_power:s0
genfscon debugfs  /vpu/vpu_memory u:object_r:debugfs_vpu_memory:s0

# mtk eara thermal reading
genfscon debugfs  /eara_thermal/enable u:object_r:debugfs_eara_thermal:s0

# mtk EM power PMU register
genfscon debugfs /rt-regmap u:object_r:debugfs_regmap:s0


genfscon iso9660 / u:object_r:iso9660:s0
genfscon rawfs / u:object_r:rawfs:s0
genfscon fuseblk / u:object_r:fuseblk:s0


